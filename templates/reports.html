{% extends 'layout.html' %}

{% block jsfiles %}
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
{% endblock %}

{% block content %}
    {% if monitorings %}
        {% for monitoring in monitorings %}
            <h2 class="bigger">{% if not monitoring.is_public %}<i class="fa fa-lock"></i> {% endif %}{{ monitoring.name }} <small><a href="{{ monitoring.url }}"><i class="fa fa-external-link"></i></a></small></h2>

            <div id="monitoring_chart_{{ monitoring.id }}" class="request-duration-chart"></div>
        {% endfor %}

        <script>
            Highcharts.setOptions({
                lang: {
                    months: [
                        '{{ _('January') }}',
                        '{{ _('February') }}',
                        '{{ _('March') }}',
                        '{{ _('April') }}',
                        '{{ _('May') }}',
                        '{{ _('June') }}',
                        '{{ _('July') }}',
                        '{{ _('August') }}',
                        '{{ _('September') }}',
                        '{{ _('October') }}',
                        '{{ _('November') }}',
                        '{{ _('December') }}'
                    ],
                    shortMonths: [
                        '{{ _('Jan') }}',
                        '{{ _('Feb') }}',
                        '{{ _('Mar') }}',
                        '{{ _('Apr') }}',
                        '{{ _('May') }}',
                        '{{ _('Jun') }}',
                        '{{ _('Jul') }}',
                        '{{ _('Aug') }}',
                        '{{ _('Sep') }}',
                        '{{ _('Oct') }}',
                        '{{ _('Nov') }}',
                        '{{ _('Dec') }}'
                    ],
                    weekdays: [
                        '{{ _('Sunday') }}',
                        '{{ _('Monday') }}',
                        '{{ _('Tuesday') }}',
                        '{{ _('Wednesday') }}',
                        '{{ _('Thursday') }}',
                        '{{ _('Friday') }}',
                        '{{ _('Saturday') }}'
                    ],
                    shortWeekdays: [
                        '{{ _('Sun') }}',
                        '{{ _('Mon') }}',
                        '{{ _('Tue') }}',
                        '{{ _('Wed') }}',
                        '{{ _('Thu') }}',
                        '{{ _('Fri') }}',
                        '{{ _('Sat') }}'
                    ]
                }
            });

            {% for monitoring in monitorings %}
                Highcharts.stockChart('monitoring_chart_{{ monitoring.id }}', {
                    title: {
                        text: '{{ _('Past %(monitoring_name)s requests duration', monitoring_name=monitoring.name) }}'
                    },
                    series: [{
                        name: '{{ _('Duration') }}',
                        data: {{ monitoring.request_duration_data|tojson }}
                    }],
                    credits: {
                        enabled: false
                    }
                });
            {% endfor %}
        </script>
    {% else %}
        <p class="alert info pas">{{ _('No reports to display a this moment.') }}</p>
    {% endif %}
{% endblock %}